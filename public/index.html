<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>ABConvert QA</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    #answer { margin-top: 1rem; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>Ask ABConvert</h1>

  <!-- 1) Question input -->
  <form id="askForm">
    <input
      id="question"
      type="text"
      placeholder="How do I set up a price A/B test?"
      style="width: 80%; padding: .5em;"
    />
    <button type="submit" style="padding: .5em 1em;">Ask</button>
  </form>

  <!-- 2) Where we’ll put the answer -->
  <div id="answer"></div>

  <!-- 3) Script that calls your JSON API and displays the text -->
  <script>
    const form     = document.getElementById('askForm');
    const input    = document.getElementById('question');
    const answerEl = document.getElementById('answer');

    form.addEventListener('submit', async e => {
      e.preventDefault();                // don’t reload the page
      const q = input.value.trim();
      if (!q) return;

      answerEl.textContent = '⏳ Thinking…';

      try {
        // call your deployed endpoint
        const res = await fetch('/api/ask', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ question: q })
        });

        if (!res.ok) {
          // show raw text if it’s an error
          const txt = await res.text();
          answerEl.textContent = '❌ ' + txt;
          return;
        }

        // parse the JSON and extract the answer field
        const { answer, error } = await res.json();
        answerEl.textContent = answer ?? '❌ ' + error;
      } catch (err) {
        answerEl.textContent = '❌ ' + err.message;
      }
    });
  </script>
</body>
</html>
